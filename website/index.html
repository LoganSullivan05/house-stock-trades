<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>House Stock Trades - Home</title>
	<style>
		* {
			box-sizing: border-box;
		}

		body {
			margin: 0;
			font-family: 'Segoe UI', sans-serif;
			background-color: #0e0e10;
			color: #e0e0e0;
		}

		nav {
			background-color: #18181b;
			padding: 12px 24px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
			position: sticky;
			top: 0;
			z-index: 10;
		}

		nav .logo {
			font-size: 20px;
			font-weight: bold;
		}

		nav a {
			color: #d4d4d8;
			text-decoration: none;
			margin-left: 20px;
			transition: color 0.2s;
		}

		nav a:hover {
			color: #9d96ff;
		}

		.main {
			padding: 24px;
		}

		.tabs {
			display: flex;
			margin-bottom: 20px;
		}

		.tabs button {
			flex: 1;
			padding: 10px;
			background: #1b1b1e;
			color: #e0e0e0;
			border: none;
			cursor: pointer;
			transition: background 0.2s;
		}

		.tabs button.active {
			background: #64629c;
		}

		.filters {
			margin-bottom: 20px;
		}

		.filters select {
			padding: 6px 10px;
			background: #1b1b1e;
			color: #e0e0e0;
			border: none;
			border-radius: 4px;
		}

		.grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
			gap: 16px;
		}

		.card {
			background: #1b1b1e;
			padding: 16px;
			border-radius: 8px;
			box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
			color: inherit;
			text-decoration: none;
		}
		.card:hover {
			color: #aaa;
		}

		.card a {
			margin: 0 0 10px;
			font-size: 18px;
		}

		.card p {
			margin: 0;
			font-size: 14px;
			/* color: #ccc; */
		}
	</style>
</head>

<body>
	<nav>
		<div class="logo">House Stock Trades</div>
		<div>
			<a target="_blank" href="/index.html">Home</a>
			<a target="_blank" href="/about.html">About</a>
			<a target="_blank" href="/chart.html">Charts</a>
		</div>
	</nav>
	<div class="main">
		<div class="tabs">
			<button id="politicianTabButton" onclick="showTab('politicians')" class="active">Politicians</button>
			<button id="stockTabButton" onclick="showTab('stocks')">Stocks</button>
		</div>

		<div class="filters" id="tradeFilter" style="display: block;">
			<label for="politicianFrequency">Top Politicians Trading:</label>
			<select id="politicianFrequency" onchange="sortPoliticians()">
				<option value="1M">1 Month</option>
				<option value="6M" selected>6 Months</option>
				<option value="1Y">1 Year</option>
				<option value="5Y">5 Years</option>
				<option value="10Y">10 Years</option>
				<option value="ALL">All</option>
			</select>
		</div>
		<div class="filters" id="stockFilter" style="display: none;">
			<label for="stockFrequency">Top Traded Stocks: </label>
			<select id="stockFrequency" onchange="sortStocks()">
				<option value="1M">1 Month</option>
				<option value="6M" selected>6 Months</option>
				<option value="1Y">1 Year</option>
				<option value="5Y">5 Years</option>
				<option value="10Y">10 Years</option>
				<option value="ALL">All</option>
			</select>
		</div>
		<div id="politiciansTab" class="grid"></div>
		<div id="stocksTab" class="grid" style="display:none;"></div>
	</div>
	<script>
		function showTab(tab) {
			document.querySelectorAll('.tabs button').forEach(btn => btn.classList.remove('active'));
			document.querySelectorAll('.grid').forEach(grid => grid.style.display = 'none');
			document.getElementById('tradeFilter').style.display = tab === 'politicians' ? 'block' : 'none';
			document.getElementById('stockFilter').style.display = tab === 'stocks' ? 'block' : 'none';

			if (tab === 'stocks') {
				document.querySelector('#stockTabButton').classList.add('active');
				document.getElementById('stocksTab').style.display = 'grid';
			} else {
				document.querySelector('#politicianTabButton').classList.add('active');
				document.getElementById('politiciansTab').style.display = 'grid';
			}
		}

		async function sortPoliticians() {
			const timeRange = document.getElementById('politicianFrequency').value;
			const container = document.getElementById('politiciansTab');
			container.innerHTML = '';

			try {
				const res = await fetch(`/api/list/politicians/${timeRange}?start=0&end=100`);
				const data = await res.json();

				data.forEach(item => {
					container.appendChild(createCard(item.insider, item.frequency));
				});
			} catch (err) {
				console.error('Failed to fetch politicians:', err);
			}
		}

		async function sortStocks() {
			const timeRange = document.getElementById('stockFrequency').value;
			const container = document.getElementById('stocksTab');
			container.innerHTML = '';

			try {
				const res = await fetch(`/api/list/stocks/${timeRange}?start=0&end=100`);
				const data = await res.json();

				data.forEach(item => {
					container.appendChild(createCard(item.company, item.frequency, item.symbol));
				});
			} catch (err) {
				console.error('Failed to fetch stocks:', err);
			}
		}

		function createCard(name, trades, symbol) {
			const container = document.createElement("a");
			const a = document.createElement("a");
			const p = document.createElement("p");
			container.classList.add("card");

			if(symbol){
				container.href = "/chart.html?symbol="+symbol;
			}
			else{
				container.href = "/table.html?insider="+name;
			}
			container.target = "_blank";
			a.textContent = name;
			p.textContent = "Trades: " + trades;
			container.appendChild(a);
			container.appendChild(p);
			
			return container;
		}
		
		sortStocks();
		sortPoliticians();
		
	</script>
</body>
</html>